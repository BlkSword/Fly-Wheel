# IntraSweep - 内网渗透辅助工具

IntraSweep 是一个基于 Rust 开发的高性能内网渗透辅助工具，提供交互式向导配置和实时进度反馈。

## 特性

- **高性能扫描** - 基于异步 I/O 的高并发扫描架构
- **交互式向导** - 友好的配置向导，无需记忆复杂参数
- **实时进度** - 可视化进度条，实时反馈扫描状态
- **多种扫描模式** - 支持端口扫描、主机发现、综合扫描
- **服务版本探测** - 自动识别开放端口的服务版本
- **系统信息收集** - 全面的系统和网络信息收集

## 安装

确保你已经安装了 Rust 开发环境，然后克隆此仓库并构建项目：

```bash
# 安装 Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env

# 克隆仓库并构建
git clone https://github.com/BlkSword/Fly-Wheel.git
cd Fly-Wheel
cargo build --release
```

构建完成后，可执行文件位于 `target/release/intrasweep.exe` (Windows) 或 `target/release/intrasweep` (Linux/macOS)。

## 使用方法

### 扫描功能 - 交互式向导（推荐）

```bash
# 进入交互式配置向导
intrasweep scan

# 或使用缩写
intrasweep sc
```

运行后会进入配置向导，逐个步骤配置扫描参数：

```
 .___        __                  _________
 |   | _____/  |_____________   /   _____/_  _  __ ____   ____ ______
 |   |/    \   __\_  __ \__  \  \_____  \\ \/ \/ // __ \/ __ \/____ \
 |   |   |  \  |  |  | \// __ \_/        \\     /\  ___/\  ___/|  |_> >
 |___|___|  /__|  |__|  (____  /_______  / /\_/  \___  >\___  >   __/
          \/                 \/        \/             \/     \/|__|

                      IntraSweep - 内网渗透辅助工具 v0.2.0

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [1/5] 扫描目标
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

输入格式示例:
  单个IP:       192.168.1.1
  IP范围:       192.168.1.1-192.168.1.100
  CIDR网段:     192.168.1.0/24
  多个目标:     192.168.1.1,192.168.1.2,192.168.1.0/24

请输入扫描目标:

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  [2/5] 扫描类型
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 端口扫描       - 扫描指定主机的开放端口
  2. 主机存活       - 检测网段内的存活主机
  3. 综合扫描       - 主机发现 + 端口扫描

请选择扫描类型 [1-3]:
```

配置完成后会显示摘要并要求确认：

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  配置确认
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  扫描目标:     192.168.1.0/24
  扫描类型:     端口扫描
  扫描预设:     Standard (标准)
  服务探测:     启用
  主机扫描方式: TCP SYN
  端口扫描方式: TCP Connect

确认开始扫描? [Y/n]:
```

扫描过程中会显示实时进度：

```
⠋ [00:00:03] [===============>                                 ] 45/100 (45%)
```

### 扫描功能 - 快速命令

```bash
# 快速扫描（使用默认配置）
intrasweep scan 192.168.1.1 port

# 指定扫描类型
intrasweep scan 192.168.1.0/24 host
intrasweep scan 192.168.1.1 comprehensive

# 启用快速扫描预设
intrasweep scan 192.168.1.1 --fast

# 指定输出文件
intrasweep scan 192.168.1.1 port -o result.json
```

### 系统信息收集

```bash
# 全量收集所有信息
intrasweep system all

# 收集网络信息
intrasweep system network

# 收集进程信息
intrasweep system process

# 使用缩写形式
intrasweep s n    # system network
intrasweep s p    # system process
```

## 命令参考

### System 子命令

| 命令 | 缩写 | 功能 |
|-----|------|-----|
| all | a | 全量收集 |
| system | sy | 基础系统信息 |
| network | n | 网络信息 |
| process | p | 进程信息 |
| credential | c | 凭据信息 |
| file | f | 文件信息 |
| domain | d | 域信息 |

### Scan 命令

| 扫描类型 | 说明 |
|---------|------|
| port | 端口扫描 - 扫描指定主机的开放端口 |
| host | 主机扫描 - 检测网段内的存活主机 |
| comprehensive | 综合扫描 - 主机发现 + 端口扫描 |

## 扫描预设

| 预设 | 并发数 | 超时 | 适用场景 |
|-----|-------|------|---------|
| Fast | 5000 | 500ms | 快速发现，大范围扫描 |
| Standard | 3000 | 1000ms | 日常扫描，平衡速度和准确性 |
| Deep | 1000 | 1500ms | 全端口扫描，详细探测 |
| Stealth | 50 | 2000ms | 隐蔽扫描，避免检测 |

## 扫描方式

### 主机扫描方式

| 方式 | 说明 | 适用场景 |
|-----|------|---------|
| TCP SYN | TCP SYN 扫描（默认） | 兼容性最好，适用于所有网络 |
| ICMP | ICMP Ping 扫描 | 需要 ICMP 权限，速度较慢但准确 |
| ARP | ARP 扫描 | 仅适用于本地网络，速度快 |
| Hybrid | 混合模式 | TCP SYN + ICMP，提高发现率 |

### 端口扫描方式

| 方式 | 说明 | 适用场景 |
|-----|------|---------|
| TCP Connect | TCP Connect 扫描（默认） | 兼容性最好，无需特殊权限 |
| TCP SYN | TCP SYN 扫描 | 需要管理员权限，隐蔽性更好 |
| UDP | UDP 扫描 | 扫描 UDP 端口，速度较慢 |

## 服务探测

支持自动识别以下服务的版本信息：

- **Web 服务**: HTTP/HTTPS (80, 443, 8080, 8000, 8443, 8888)
- **数据库**: MySQL (3306), PostgreSQL (5432), MSSQL (1433), Redis (6379), MongoDB (27017)
- **邮件服务**: SMTP (25, 587), POP3 (110), IMAP (143)
- **远程访问**: SSH (22), Telnet (23), RDP (3389), VNC (5900)
- **文件服务**: FTP (21), SMB (445)
- **其他服务**: DNS (53), LDAP (389), RPC (111), Elasticsearch (9200)

## 输出格式

扫描结果会自动保存为 JSON 格式，文件名格式：

```
intrasweep-scan-<目标>-<时间戳>.json
```

示例文件名：
```
intrasweep-scan-192.168.1.1-20240117-143025.json
```

## 性能指标

- **端口扫描**: 单核服务器上 3 秒完成全端口扫描
- **主机发现**: 254 个 IP — TCP 2s，ICMP 15s
- **并发能力**: 最高支持 20000+ 并发连接

## 技术栈

- **语言**: Rust
- **异步运行时**: Tokio
- **CLI 框架**: clap
- **进度显示**: indicatif
- **序列化**: serde_json

## 注意事项

1. **网络权限**: 主机扫描需要适当的网络权限
2. **服务探测**: 会增加扫描时间，建议仅在需要时启用
3. **隐蔽模式**: Stealth 模式会显著降低扫描速度，但隐蔽性更好
4. **合法使用**: 请确保在合法授权的范围内使用此工具

## 许可证

本项目仅供学习和研究使用。
